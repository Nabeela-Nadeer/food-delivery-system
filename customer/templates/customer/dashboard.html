<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Customer Dashboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
  <style>
    body {
      background: #f8f9fa;
      min-height: 100vh;
    }
    .card-hover:hover {
      transform: translateY(-8px);
      box-shadow: 0 1rem 2rem rgba(0,0,0,0.15);
      transition: all 0.3s ease;
      cursor: pointer;
    }
    .btn-wide {
      min-width: 140px;
    }
    .gradient-header {
      background: linear-gradient(135deg, #6f42c1, #6610f2);
      color: white;
      border-radius: 0.375rem;
      padding: 2rem 1rem;
      box-shadow: 0 0.25rem 0.5rem rgba(111,66,193,.4);
      margin-bottom: 2rem;
      text-align: center;
    }
    .gradient-header h1 {
      font-weight: 700;
      font-size: 2.8rem;
      text-shadow: 0 0.1rem 0.25rem rgba(0,0,0,0.2);
    }
    .btn-outline-chat {
      border-color: #6610f2;
      color: #6610f2;
      transition: background-color 0.3s, color 0.3s;
    }
    .btn-outline-chat:hover {
      background-color: #6610f2;
      color: white;
      border-color: #6610f2;
    }
    .card-img-top {
      border-bottom: 3px solid #6610f2;
    }
  </style>
</head>
<body>
  <div class="container py-5">
    <!-- Header -->
    <div class="gradient-header">
      <h1>Welcome, {{ user.first_name }}!</h1>
      <a href="{% url 'customer_logout' %}" class="btn btn-danger btn-wide mt-3 shadow-sm">Logout</a>
    </div>

    <!-- Action Cards -->
    <div class="row g-4 mb-5">
      <div class="col-md-4">
        <div class="card shadow-sm rounded-4 card-hover h-100">
          <div class="card-body d-flex flex-column">
            <h5 class="card-title fw-bold">Profile</h5>
            <p class="mb-1"><strong>Name:</strong> {{ user.get_full_name }}</p>
            <p class="mb-1"><strong>Email:</strong> {{ user.email }}</p>
            {% if profile %}
              <p class="mb-1"><strong>Phone:</strong> {{ profile.phone }}</p>
              <p class="mb-3"><strong>Address:</strong> {{ profile.address }}</p>
            {% endif %}
            <a href="{% url 'customer_profile' %}" class="btn btn-primary mt-auto btn-wide shadow-sm">Edit Profile</a>
          </div>
        </div>
      </div>

      <div class="col-md-4">
        <div class="card shadow-sm rounded-4 card-hover h-100">
          <div class="card-body d-flex flex-column">
            <h5 class="card-title fw-bold">Browse Restaurants</h5>
            <p class="mb-4 text-muted flex-grow-1">Explore nearby restaurants and their menus.</p>
            <a href="{% url 'restaurant_list' %}" class="btn btn-success btn-wide shadow-sm mt-auto">Browse</a>
          </div>
        </div>
      </div>

      <div class="col-md-4">
        <div class="card shadow-sm rounded-4 card-hover h-100">
          <div class="card-body d-flex flex-column">
            <h5 class="card-title fw-bold">Order History</h5>
            <p class="mb-4 text-muted flex-grow-1">View your past orders</p>
            <a href="{% url 'order_history' %}" class="btn btn-info btn-wide shadow-sm mt-auto">View Orders</a>
          </div>
        </div>
      </div>
    </div>

    <!-- Wallet Card -->
    <div class="row g-4 mb-5">
      <div class="col-md-4">
        <div class="card shadow-sm rounded-4 card-hover">
          <div class="card-body d-flex flex-column">
            <h5 class="card-title fw-bold">Wallet</h5>
            <p class="mb-4 text-muted flex-grow-1">Check your wallet balance.</p>
            <a href="{% url 'wallet' %}" class="btn btn-warning btn-wide shadow-sm mt-auto">Go to Wallet</a>
          </div>
        </div>
      </div>
    </div>

    <!-- Latest Menu Items -->
    <h3 class="mb-4 text-center fw-bold">Latest Menu Items</h3>
    <div class="row row-cols-1 row-cols-md-3 g-4">
      {% for item in recent_items %}
      <div class="col d-flex justify-content-center">
        <div class="card rounded-4 shadow-sm" style="width: 18rem; height: 380px; overflow: hidden;">
          {% if item.image %}
            <img src="{{ item.image.url }}" alt="{{ item.name }}" class="card-img-top" style="height: 150px; object-fit: cover;">
          {% else %}
            <img src="https://via.placeholder.com/300x150?text=No+Image" class="card-img-top" alt="No image available">
          {% endif %}
          <div class="card-body d-flex flex-column">
            <h5 class="card-title fw-semibold">{{ item.name }}</h5>
            <p class="card-text fs-5 text-success fw-bold mb-2">â‚¹{{ item.price }}</p>
            <p class="card-text text-muted mb-3"><small>From: {{ item.restaurant.name }}</small></p>
            <a href="{% url 'order_now' item.id %}" class="btn btn-primary btn-wide shadow-sm">Order Now</a>
            {% if item.restaurant.user %}
              <a href="{% url 'chat_view' item.restaurant.user.id %}" class="btn btn-outline-chat btn-wide mt-2 shadow-sm">
                Chat with Restaurant
              </a>
            {% endif %}
          </div>
        </div>
      </div>
      {% empty %}
      <p class="text-center text-muted">No menu items available.</p>
      {% endfor %}
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
